import type { AchievementDef } from '$lib/models/types';

// =====================================
// チュートリアル系 (priority: 1-100)
// =====================================
export const tutorialAchievements: Record<string, AchievementDef> = {
  ach_game_start: {
    id: 'ach_game_start',
    title: '新しい日々',
    description: 'フォンテ村に到着した',
    hint: '物語が始まる',
    category: 'tutorial',
    narrative: 'village_growth',
    narrativeCharacter: { name: '村長', title: 'フォンテ村長' },
    eventImage: 'arrival_village',
    narrativeLines: [
      { text: 'おお、ついに来てくれたか！ 君がイリーナ先生の弟子だな', expression: 'happy' },
      '私はこの村の村長をやっている。もう何年も組合に頼み続けてな……',
      'ここが君の工房だ。少し古いが、娘と一緒に掃除しておいた',
      'フォンテ村を頼む。君が来てくれるのを、村のみんなが待っていたんだ',
    ],
    conditions: [{ type: 'day', target: 1 }],
    reward: {
      unlocks: ['inventory', 'rest'],
    },
    priority: 1,
    autoComplete: true,
  },

  ach_check_inventory: {
    id: 'ach_check_inventory',
    title: '旅の荷ほどき',
    description: '持ち物を確認した',
    hint: '<strong>所持品</strong>を開いて持ち物を調べよう',
    category: 'tutorial',
    narrative: 'workshop_discovery',
    narrativeLines: [
      '工房に運び込まれた荷物を整理した',
      '師匠が持たせてくれた道具と素材……それに、何冊かの教本',
      'この教本があれば、基礎の復習から始められそうだ',
      'まずはこれで、やれるだけやってみよう',
    ],
    conditions: [{ type: 'inventory_opened', target: 1 }],
    reward: {
      items: [
        { itemId: 'herb_01', quality: 50, quantity: 5 },
        { itemId: 'water_01', quality: 50, quantity: 3 },
      ],
      originLabel: '持参品',
      unlocks: ['study'],
    },
    prerequisite: ['ach_game_start'],
    priority: 2,
    important: true,
  },

  ach_first_recipe: {
    id: 'ach_first_recipe',
    title: '知識の扉',
    description: '最初のレシピを習得した',
    hint: '<strong>勉強</strong>してレシピを習得しよう',
    category: 'tutorial',
    narrative: 'master_teaching',
    narrativeCharacter: { name: 'イリーナ', title: '師匠（手紙）' },
    narrativeLines: [
      '師匠からの手紙が届いた――',
      'まずは基本を思い出しなさい。あなたの座学は誰にも負けないはずよ',
      'これは餞別。実地でこそ錬金術は身につくもの。頑張りなさい',
    ],
    conditions: [{ type: 'recipe_count', target: 1 }],
    reward: {
      items: [{ itemId: 'herb_01', quality: 50, quantity: 3 }],
      originLabel: '師匠イリーナからの仕送り',
      unlocks: ['alchemy'],
    },
    prerequisite: ['ach_check_inventory'],
    priority: 10,
    important: true,
  },

  ach_first_craft: {
    id: 'ach_first_craft',
    title: '錬金術士の目覚め',
    description: '初めて調合に成功した',
    hint: 'アイテムを<strong>調合</strong>してみよう',
    category: 'tutorial',
    narrative: 'villager_gift',
    narrativeCharacter: { name: 'メルダ', title: 'よろず屋のおばちゃん' },
    narrativeLines: [
      'あらあら、あんたが噂の先生かい？ 私はメルダよ',
      { text: 'もう薬が作れるの？ すごいねえ！', expression: 'happy' },
      'はい、これ使いなさいな。うちの店にあった素材だけど、先生の方が上手に使えるでしょ',
      '実はちょっと頼みたいこともあるの。村長んとこに言ってあるから、依頼を見てちょうだいな',
    ],
    conditions: [{ type: 'craft_count', target: 1 }],
    reward: {
      items: [
        { itemId: 'water_01', quality: 50, quantity: 3 },
        { itemId: 'ore_01', quality: 40, quantity: 2 },
      ],
      originLabel: 'メルダが店から分けてくれた',
      unlocks: ['quest'],
    },
    priority: 20,
    prerequisite: ['ach_first_recipe'],
    important: true,
  },

  ach_first_shop: {
    id: 'ach_first_shop',
    title: 'よろず屋の誘い',
    description: 'メルダの店を利用できるようになった',
    hint: '<strong>依頼</strong>を受けてみよう',
    category: 'tutorial',
    narrative: 'villager_gift',
    narrativeCharacter: { name: 'メルダ', title: 'よろず屋のおばちゃん' },
    narrativeLines: [
      { text: 'あら先生、依頼引き受けてくれたんだって？ ありがとねぇ！', expression: 'happy' },
      '素材集めが大変でしょ？ うちの店に来なさいよ',
      '色々取り揃えてるから、きっと役に立つわよ',
    ],
    conditions: [{ type: 'active_quest_count', target: 1 }],
    reward: {
      unlocks: ['shop'],
    },
    priority: 30,
    prerequisite: ['ach_first_craft'],
    important: true,
  },

  ach_first_complete: {
    id: 'ach_first_complete',
    title: 'おばあちゃんの知恵',
    description: '初めて依頼を完了し、リーネが少し態度を軟化させた',
    hint: '<strong>依頼</strong>を達成して納品しよう',
    category: 'tutorial',
    narrative: 'village_girl',
    narrativeCharacter: { name: 'リーネ', title: '村娘' },
    narrativeLines: [
      '……依頼、達成したんだって？ お父さんが喜んでたわよ',
      '……ねえ。あんたが納品した薬、うちのおばあちゃんが昔作ってたのと似てるの',
      'あんたの錬金術と、おばあちゃんの知恵……似てるところ、あるのかも',
      { text: '……べっ、別に認めたわけじゃないから。ただの興味よ', expression: 'embarrassed' },
    ],
    conditions: [{ type: 'quest_count', target: 1 }],
    reward: {
      reputation: 3,
      unlocks: ['album'],
    },
    priority: 40,
    prerequisite: ['ach_first_craft', 'ach_story_village_girl_cold'],
    important: true,
  },

  ach_inspection_intro: {
    id: 'ach_inspection_intro',
    title: '試験の代価',
    description: '査察官から査察制度の説明を受けた',
    hint: '',
    category: 'tutorial',
    narrative: 'patron_support',
    narrativeCharacter: { name: '査察官', title: '師匠組合' },
    eventImage: 'inspection_intro',
    narrativeLines: [
      '師匠組合の査察部です。派遣錬金術師の初期登録確認に参りました',
      '制度を説明します。組合は3ヶ月ごとに経過報告を求め、1年後に最終査察を行います',
      '依頼の実績、錬金術の腕前、村への貢献……すべてが評価対象です',
      '実績なき者は召還。それだけのことです。……精励を期待します',
    ],
    conditions: [],
    reward: {},
    priority: 42,
    prerequisite: ['ach_first_complete'],
  },

  ach_rival_intro: {
    id: 'ach_rival_intro',
    title: '同期の錬金術師',
    description: 'ライバル錬金術師ヴィクトに出会った',
    hint: '',
    category: 'tutorial',
    narrative: 'rival_pressure',
    narrativeCharacter: { name: 'ヴィクト', title: 'ライバル錬金術師' },
    eventImage: 'inspection_intro',
    narrativeLines: [
      'ああ、君がここの担当か。僕はヴィクト、隣村に派遣された錬金術師だ',
      'イリーナ先生の弟子だって？ ふうん……まぁ、お互い頑張ろうじゃないか',
      { text: 'もっとも、僕はもう工房の整備も終わってるけどね', expression: 'smug' },
      '次の査察で会おう。……楽しみにしてるよ',
    ],
    conditions: [],
    reward: {},
    priority: 43,
    prerequisite: ['ach_inspection_intro'],
  },

  ach_adventurer_arrival: {
    id: 'ach_adventurer_arrival',
    title: '冒険者の到来',
    description: '村発展度が20に達した',
    hint: '<strong>村発展度20</strong>を目指そう',
    category: 'tutorial',
    narrative: 'character_trial',
    narrativeCharacter: { name: 'レン', title: '冒険者' },
    narrativeLines: [
      'あんたがこの村の錬金術師か。俺はレン、こいつはフィー。冒険者をやってる',
      '面白い村があると聞いてな。錬金術師がいるなら素材の需要もあるだろ？',
      '森の奥まで行ける。金は貰うが、悪い取引にはならないさ',
      'フィー「よろしくねー！ 珍しいもの見つけたら教えるから！」',
    ],
    conditions: [{ type: 'village_development', target: 20 }],
    reward: {
      unlocks: ['expedition'],
    },
    priority: 45,
    prerequisite: ['ach_first_complete'],
    important: true,
  },

  ach_first_expedition: {
    id: 'ach_first_expedition',
    title: '仲間との協力',
    description: '初めて採取隊を派遣した',
    hint: '<strong>採取</strong>隊を派遣して素材を集めよう',
    category: 'tutorial',
    narrative: 'character_trial',
    narrativeCharacter: { name: 'レン', title: '冒険者' },
    narrativeLines: [
      'フィー「これ、帰り道で見つけたの！ おまけだよー」',
      'レン「……見込みがあるな。次も頼んでくれ」',
    ],
    conditions: [{ type: 'expedition_count', target: 1 }],
    reward: {
      items: [{ itemId: 'herb_01', quality: 60, quantity: 2 }],
      originLabel: 'フィーが帰り道で見つけたおまけ',
    },
    priority: 50,
    prerequisite: ['ach_adventurer_arrival'],
    important: true,
  },
};
